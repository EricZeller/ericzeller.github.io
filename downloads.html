<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Downloads | ericzeller.github.io</title>
    <link rel="icon" href="./src/logo_z_round.png">
    <link rel="stylesheet" href="./css/style.css">

    <style type = text/css>
        a.download-link {text-decoration: underline;}
    </style>

</head>



<body>
    <header>
        <a href="./index.html" class="logo">
            <img src="./src/logo_z_white_nobackground.png" alt="Logo">
        </a>
        <ion-icon name="menu" class="menu-toggle"></ion-icon>

        <nav class="menu">
            <ul>
                <li><a href="./index.html" class="__active">Home</a></li>
                <li><a href="./projects.html">Projects</a></li>
                <li><a href="./servers.html">Servers</a></li>
                <li><a href="./servers.html">OSs & Software</a></li>
                <li><a href="./downloads.html">Downloads</a></li>
                <li><a href="./about.html">About</a></li>
            </ul>

        </nav>


    </header>

    <section class="hidden" style="padding-bottom: 0;">
        <h1>Downloads.</h1>
    </section>

    <div class="projectcontainer hidden"></div>

    <section class="hidden">
        <p>Still expanding.</p>
    </section>

    <div class="spacer layer4"></div>

    <section class="pink footer">
        <p class="hidden" id="copyright"></p>
    </section>

    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script src="./scripts/main.js"></script>
    <script>
        const projects = [
            {
                name: "Tippy",
                githubRepo: "EricZeller/tippy"
            },
            // projects to add here
        ];

        const accessToken = 'none';

        const projectContainer = document.querySelector('.projectcontainer');

        projects.forEach(project => {
            const ownerAndRepo = project.githubRepo.split('/');
            const owner = ownerAndRepo[0];
            const repo = ownerAndRepo[1];

            fetch(`https://api.github.com/repos/${owner}/${repo}`, {
                headers: {
                    Authorization: `token ${accessToken}`
                }
            })
                .then(response => response.json())
                .then(repoInfo => {
                    const description = repoInfo.description;

                    fetch(`https://api.github.com/repos/${owner}/${repo}/releases`, {
                        headers: {
                            Authorization: `token ${accessToken}`
                        }
                    })
                        .then(response => response.json())
                        .then(releases => {
                            const latestRelease = releases[0];
                            const projectName = project.name;
                            const latestVersion = latestRelease.tag_name;
                            const downloadLink = latestRelease.assets[0].browser_download_url;

                            const projectElement = document.createElement('div');
                            projectElement.classList.add('project');

                            const titleElement = document.createElement('h2');
                            titleElement.textContent = projectName;
                            projectElement.appendChild(titleElement);

                            const descriptionElement = document.createElement('p');
                            descriptionElement.classList.add('description');
                            descriptionElement.textContent = description;
                            projectElement.appendChild(descriptionElement);

                            const versionElement = document.createElement('p');
                            versionElement.classList.add('latest-version');
                            versionElement.textContent = `Current version: ${latestVersion}`;
                            projectElement.appendChild(versionElement);

                            const downloadLinkElement = document.createElement('a');
                            downloadLinkElement.classList.add('download-link');

                            

                            downloadLinkElement.textContent = 'Download ';
                            downloadLinkElement.href = downloadLink;
                            projectElement.appendChild(downloadLinkElement);

                            const iconElement = document.createElement('ion-icon');
                            iconElement.setAttribute('name', 'cloud-download'); 
                            downloadLinkElement.appendChild(iconElement);

                            projectContainer.appendChild(projectElement);
                        })
                        .catch(error => console.error('Fehler beim Abrufen der Releases:', error));
                })
                .catch(error => console.error('Fehler beim Abrufen der Repository-Informationen:', error));
        });
    </script>
</body>

</html>